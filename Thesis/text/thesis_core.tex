%\setmainfont{XITS}
%\setmathfont{XITS Math}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Workflow
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\long\def\red#1{\color{red} #1 \color{black}}

\newenvironment{TODO}{%
  \color{blue} \itshape \begin{itemize}
}{%
  \end{itemize}
}

\newcommand{\warnme}[1]{{\color{red} \textbf{$[$} #1 \textbf{$]$}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Agda related stuff
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% empty env, maybe later we can add some style to it.
\newenvironment{agdacode}{%
\vspace{.5em}
\hspace{1em}
\begin{minipage}[t]{.8\textwidth}
}{%
\end{minipage}
\vspace{.5em}
}

\newcommand{\Agda}[2]{%
\begin{agdacode}
\ExecuteMetaData[code/agda/excerpts/#1.tex]{#2}
\end{agdacode}
}


\newenvironment{agdacodeInd}{%
\vspace{.5em}
\hspace{-1em}
\begin{minipage}[t]{.8\textwidth}
}{%
\end{minipage}
\vspace{.5em}
}

\long\def\ignore#1{}

%% Notation
\newcommand{\inlagda}[1]{$\mathsf{\small #1}$}
\newcommand{\catname}[1]{\textbf{#1}}

%%%% Relational Notation
\newcommand{\releq}{\equiv_r}

%% Agda shortcuts
\newcommand{\D}[1]{\AgdaDatatype{#1}}
\newcommand{\F}[1]{\AgdaFunction{#1}}
\newcommand{\K}[1]{\AgdaKeyword{#1}}
\newcommand{\N}[1]{\AgdaSymbol{#1}}
\newcommand{\IC}[1]{\AgdaInductiveConstructor{#1}}
\newcommand{\ICArgs}[2]{\AgdaInductiveConstructor{#1}$\; #2 $}
\newcommand{\DArgs}[2]{\D{#1}$\; #2 $}

%% Operations
\def\conc{+\hspace{-.3em}+}

%% hyphen for math mode
\mathchardef\hyph="2D
\def\scata#1{\mathopen{(\!|}#1\mathclose{|\!)}}

\def\llbracket{\mathopen{(\!|}}
\def\rrbracket{\mathclose{|\!)}}

%%%%%%%%%%%%
%% Squiggol
%\def\justl#1#2#3{\\ &#1& \rule{2em}{0pt} \{ \mbox{\rule[-.7em]{0pt}{1.8em} \small #3 \label{eq:#2} \/} \} \\ && } % labelled just
%\def\nojust#1#2{ &#1& }
%\def\just#1#2{\\ &#1& \rule{2em}{0pt} \{ \mbox{\rule[-.7em]{0pt}{1.8em} \small #2 \/} \} \nonumber\\ && }
\newcommand{\justl}[3]%
{\nonumber \\ & #1 & \rule{2em}{0pt} \{ \mbox{\rule[-.7em]{0pt}{1.8em} \small #3 \label{eq:#2} \/} \} \\ && }
\newcommand{\ljust}[3]%
{\\ & #1 \label{eq:#2}  & \rule{2em}{0pt} \{ \mbox{\rule[-.7em]{0pt}{1.8em} \small #3  \/} \} \\ && }
\newcommand{\just}[2]%
{\nonumber \\ & #1 & \rule{2em}{0pt} \{ \mbox{\rule[-.7em]{0pt}{1.8em} \small #2 \/} \} \nonumber \\ && }
\newcommand{\nojust}[2]%
{ & #1 \nonumber & }

%for some reasons, LaTeX does not like unicode chars outside math mode.
%therefore we have to define them here.
%\newcommand{\textrho}{$\rho$}
%\newcommand{\textLambda}{$\Lambda$}
%\newcommand{\textpi}{$\pi$}

% And some others that actually require the unicode declaration
\DeclareUnicodeCharacter {10627}{\{\hspace {-.2em}[}
\DeclareUnicodeCharacter {10628}{]\hspace {-.2em}\}}
\DeclareUnicodeCharacter {8759}{::}
\DeclareUnicodeCharacter {8718}{$\square$}
\DeclareUnicodeCharacter {7523}{$_r$}
\DeclareUnicodeCharacter {7506}{$^\circ$}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}[chapter]
\newtheorem{crl}{Corolary}[chapter]
\newtheorem{prob}{Problem}[chapter]
\newtheorem{prop}{Proposition}[chapter]

\theoremstyle{definition}
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{mydef}{Definition}[chapter]
\newtheorem{notation}{Notation}[chapter]

\theoremstyle{remark}
\newtheorem{nota}{Note}[chapter]
